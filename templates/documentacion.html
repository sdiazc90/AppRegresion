<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Documentación</title>

    <!-- Estilos básicos para acordeón -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: auto;
            max-width: 90%;
        }
        h1 {
            text-align: center;
        }
        .accordion {
            background-color: #eee;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .accordion-header {
            cursor: pointer;
            padding: 15px;
            font-weight: bold;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .accordion-header:hover {
            background-color: #ddd;
        }
        .accordion-content {
            padding: 15px;
            display: none;
            border-top: 1px solid #ccc;
            background-color: #fafafa;
        }
        .accordion-content.show {
            display: block;
        }
        .accordion-header::after {
            content: "▶";
            transition: transform 0.3s ease;
        }
        .accordion-header.active::after {
            transform: rotate(90deg);
        }
        /* Para que el gráfico tome ancho completo y sea responsive */
        iframe {
            width: 100%;
            height: 700px;
            border: none;
            display: block;
            margin-bottom: 20px;
        }
        /* Ajuste de margen de párrafos */
        .accordion-content p {
            margin: 0.5em 0;
        }
    </style>

    <!-- Plotly.js desde CDN -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

    <!-- Enlace al inicio -->
    <div style="margin: 20px; text-align: left;">
        <a href="/" style="text-decoration: none; font-size: 18px; color: #007BFF; font-weight: bold;">
            &#8592; Volver al inicio
        </a>
    </div>

    <h1>Documentación del Proyecto</h1>

    <!-- Sección 1 -->
    <div class="accordion">
        <div class="accordion-header">1) Obtención y limpieza de datos</div>
        <div class="accordion-content">
            <p>Los datos se obtuvieron mediante scraping de MercadoLibre …</p>
            <img src="static/images/MSA.png" alt="Gráfico MSA" style="max-width: 40%; height: auto; margin-top: 10px;" />
            <!-- iframe generado con include_plotlyjs='cdn' y responsive -->
            <iframe src="static/plots/precio_modelo_selectivo.html"></iframe>
            <p>Finalmente la cantidad de muestras es:</p>
            <iframe src="static/plots/numero_muestras_marcas.html"></iframe>
        </div>
    </div>

    <!-- Sección 2 -->
    <div class="accordion">
        <div class="accordion-header">2) Análisis de Datos</div>
        <div class="accordion-content">
            <p>En esta sección se muestran algunas gráficas de los datos limpios</p>
            <iframe src="static/plots/precio_medio_marcas.html"></iframe>
            <p>Se puede ver un pico de Jeep en 2015 …</p>
            <iframe src="static/plots/violin_precios_marcas.html"></iframe>
            <p>Además una alta dispersión de precio entre modelos.</p>
            <iframe src="static/plots/treemap_marcas_modelos.html"></iframe>
            <p>Y como en promedio los vehículos usados Jeep son los más caros …</p>
            <iframe src="static/plots/correlacion_mapa.html" style="height: 500px;"></iframe>
        </div>
    </div>

    <!-- Sección 3 -->
    <div class="accordion">
        <div class="accordion-header">3) Entrenamiento de Modelo</div>
        <div class="accordion-content">
            <p>Finalmente para entrenar modelos de Machine Learning utilizamos tres …</p>
            <img src="static/images/r2_modelosconeleccion_sin_tuneo.png" alt="R2 sin tuneo" style="max-width: 60%; height: auto;" />
            <p>Luego pasamos a tunear hiperparámetros de los dos mejores.</p>
            <img src="static/images/r2_modelosconeleccion_con_tuneo.png" alt="R2 con tuneo" style="max-width: 60%; height: auto;" />
        </div>
    </div>

    <!-- Script acordeón + redibujo Plotly al abrir -->
    <script>
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const wasActive = header.classList.contains('active');
                // Cerrar todo
                document.querySelectorAll('.accordion-header').forEach(h => h.classList.remove('active'));
                document.querySelectorAll('.accordion-content').forEach(c => c.classList.remove('show'));
                // Si no estaba abierto, ábrelo
                if (!wasActive) {
                    header.classList.add('active');
                    const content = header.nextElementSibling;
                    content.classList.add('show');
                    // Forzar redibujo de cada iframe Plotly
                    content.querySelectorAll('iframe').forEach(iframe => {
                        // Ajustar dimensiones actuales para disparar resize
                        iframe.style.width  = iframe.clientWidth  + 'px';
                        iframe.style.height = iframe.clientHeight + 'px';
                        // Disparar evento resize dentro del iframe
                        if (iframe.contentWindow) {
                            iframe.contentWindow.dispatchEvent(new Event('resize'));
                        }
                    });
                }
            });
        });
    </script>

</body>
</html>

